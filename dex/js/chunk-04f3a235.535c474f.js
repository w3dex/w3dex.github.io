(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04f3a235"],{2225:function(t,e,s){},b73e:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("van-popup",{attrs:{position:"left"},on:{click:function(e){t.show=!1}},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("div",{staticClass:"menus",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.$t("market.text1")))])]),e("div",{staticClass:"search-bar"},[e("van-icon",{attrs:{name:"search"}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchValue,expression:"searchValue"}],attrs:{type:"text",placeholder:t.$t("market.text2")},domProps:{value:t.searchValue},on:{input:[function(e){e.target.composing||(t.searchValue=e.target.value)},t.searchPair]}})],1),e("div",{staticClass:"markets-symbol"},t._l(t.golds,(function(s,i){return e("span",{class:{active:i==t.currentIndex},on:{click:function(e){return t.selectGold(i)}}},[t._v(t._s(s.symbol))])})),0),e("div",{staticClass:"tags"},[e("span",[t._v(t._s(t.$t("market.text3")))]),e("div",{on:{click:t.sortForPrice}},[e("span",[t._v(t._s(t.$t("market.text4")))]),e("img",{attrs:{src:s("133b")}})]),e("div",{on:{click:t.sortForQuote}},[e("span",[t._v(t._s(t.$t("market.text5")))]),e("img",{attrs:{src:s("133b")}})])]),e("div",{staticClass:"list"},[t._l(t.filterList,(function(s){return e("div",{directives:[{name:"show",rawName:"v-show",value:!t.searching,expression:"!searching"}],key:s.address,staticClass:"list-item",on:{click:function(e){return t.changePair(s)}}},[e("div",{staticClass:"token"},[e("img",{attrs:{src:s.logoURI}}),e("span",[t._v(t._s(s.token.symbol)),e("span",[t._v("/"+t._s(s.gold.symbol))])])]),e("span",[t._v(t._s(s.price.toFixed(2)))]),e("span",{class:s.isDrop?"drop":"rise"},[t._v(t._s(s.quote))])])})),e("div",{directives:[{name:"show",rawName:"v-show",value:t.searching,expression:"searching"}],staticClass:"loading"},[e("van-loading",{attrs:{type:"spinner",color:"#F2B60A"}}),e("span",[t._v(t._s(t.$t("searching")))])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.searching&&t.searchValue.length&&0===t.filterList.length,expression:"!searching && searchValue.length && filterList.length === 0"}],staticClass:"empty"},[e("img",{attrs:{src:s("8479")}}),e("span",[t._v(t._s(t.$t("no_search_content_yet")))])])],2)])])},r=[],a=(s("68ef"),s("a71a"),s("9d70"),s("3743"),s("4d75"),s("e41f")),o=(s("ac1e"),s("543e")),c=(s("c3a6"),s("ad06")),n=(s("14d9"),s("2f62")),l=s("044d"),h=s("25ba"),d=s("ed08"),u=s("3e75"),m=s("0319"),f=s("d925"),g=s("b9cc"),p={components:{[c["a"].name]:c["a"],[o["a"].name]:o["a"],[a["a"].name]:a["a"]},data(){return{show:!1,currentIndex:0,list:[],filterList:[],state:"open",searchValue:"",priceDirection:"default",quoteDirection:"default",searching:!1}},computed:{...Object(n["b"])(["web3","pair","chainId"]),golds(){var t;return null!==(t=h["a"][this.chainId])&&void 0!==t?t:[]},currentSymbol(){return this.golds.length>0?this.golds[this.currentIndex].symbol:""}},async created(){const t=sessionStorage.getItem("pairList");if(this.selectGold(this.golds.findIndex(t=>t.symbol===this.pair.gold.symbol)),t&&(this.list=[...JSON.parse(t)],this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol)),!this.web3)return;const e=await fetch(`${u["c"]}/pairs/${this.chainId}.json`).then(t=>t.json()),s=[...e.map(t=>({...t,price:"0",quote:"+0%",isDrop:!1,volume:"0",marketValue:"0"}))];for(let r=0;r<e.length;r++)try{const t=e[r].gold.decimals+18-e[r].token.decimals,i=await Object(l["a"])(e[r].address);if(i.length>0){const a=i[0].price.fromWei(t);s[r].price=a;const o=Math.floor((new Date).getTime()/1e3),c=86400*Math.floor(o/86400),n=await Object(l["a"])(e[r].address,c);if(n.length>0){const e=n[0].price.fromWei(t).toBN();s[r].isDrop=e.gt(a);const i=e.gt(a)?e.minus(a):a.toBN().minus(e),o=i.div(e).times(100).toFixed().toFixed(2);e.gt(a)?s[r].quote=`-${o}%`:s[r].quote=`+${o}%`}}}catch(i){}this.list=s,this.filterList=s.filter(t=>t.gold.symbol===this.currentSymbol),sessionStorage.setItem("pairList",Object(d["a"])(s))},methods:{open(){this.show=!0},changePair(t){this.$store.commit("setPair",t),this.$store.commit("setShow",!1),this.$nextTick(()=>{this.$store.commit("setShow",!0)})},selectGold(t){if(this.currentIndex=t,this.quoteDirection="default",this.priceDirection="default",this.searchValue.length)return this.searchPair();this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol)},sortForPrice(){"desc"===this.priceDirection?(this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol).sort((t,e)=>Number(t.price)-Number(e.price)),this.priceDirection="asc"):(this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol).sort((t,e)=>Number(e.price)-Number(t.price)),this.priceDirection="desc"),"default"!==this.quoteDirection&&(this.quoteDirection="default")},sortForQuote(){"desc"===this.quoteDirection?(this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol).sort((t,e)=>Number(t.quote.slice(0,-1))-Number(e.quote.slice(0,-1))),this.quoteDirection="asc"):(this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol).sort((t,e)=>Number(e.quote.slice(0,-1))-Number(t.quote.slice(0,-1))),this.quoteDirection="desc"),"default"!==this.priceDirection&&(this.priceDirection="default")},async getPriceInfo(t,e){const s=Math.floor((new Date).getTime()/1e3),i=86400*Math.floor(s/86400),r=await Object(l["a"])(t),a=await Object(l["a"])(t,i);let o="0",c="+0%",n=!1;if(r.length){const t=r[0].price.fromWei(e);if(o=t,a.length){const s=a[0].price.fromWei(e).toBN(),i=s.gt(t)?s.minus(t):t.toBN().minus(s),r=i.div(s).times(100).toFixed().toFixed(2);n=s.gt(t),c=n?`-${r}%`:`+${r}%`}}return{price:o,quote:c,isDrop:n}},async searchPair(){if(0===this.searchValue.length)return void(this.filterList=this.list.filter(t=>t.gold.symbol===this.currentSymbol));if(!this.web3.utils.isAddress(this.searchValue))return void(this.filterList=[]);this.searching=!0;const t=[];for(let e=0;e<this.filterList.length;e++){if(!this.filterList[e].token.address.toBN().eq(this.searchValue.toBN()))continue;const s=this.filterList[e].gold.decimals+18-this.filterList[e].token.decimals,i=await this.getPriceInfo(this.filterList[e].address,s);t.push({...this.filterList[e],...i});break}if(0===t.length){const e=new this.web3.eth.Contract(f.abi,m["a"][this.chainId].Controller),s=await e.methods.getPair(this.searchValue,this.golds[this.currentIndex].address).call();if(s.toBN().gt(0)){const e=new this.web3.eth.Contract(g,this.searchValue),i=await e.methods.symbol().call(),r=await e.methods.decimals().call(),a=this.golds[this.currentIndex].decimals+18-r,o=await this.getPriceInfo(s,a);t.push({...o,gold:this.golds[this.currentSymbol],token:{symbol:i,decimals:r,name:"",address:this.searchValue},logoURI:"",address:s})}}this.filterList=t,this.searching=!1}}},b=p,v=b,w=(s("c2ab"),s("2877")),y=Object(w["a"])(v,i,r,!1,null,"4d34d7fa",null);e["default"]=y.exports},c2ab:function(t,e,s){"use strict";s("2225")}}]);