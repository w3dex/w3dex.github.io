import{E as L,u as _,j as A,l as B,n as d,G as D,P as G,O as R,C as U,q as s,Q as v}from"./vendor-05c9a28e.js";import{c as $,g as f,S as F,t as j,b as O,y as T,s as V}from"./index-3ad86714.js";import{L as J}from"./loading-3c5d2442.js";const Q="/assets/empty-8f18b8b1.svg";async function S(m,r){let n="0",u="+0%",l=!1;try{const c=await O(m,r),a=await T(m,r);if(c.length){const o=v(c[0].price);if(n=o,a.length){const i=v(a[0].price);if(l=Number(i)>Number(o),l){const h=Number(i)-Number(o);u=`-${j(h/Number(i)*100)}%`}else{const h=Number(o)-Number(i);u=`+${j(h/Number(i)*100)}%`}}}}catch{}return{price:n,quote:u,isDrop:l}}function M(){const m=L(),r=_(),{t:n}=A(),{address:u}=B(),l=sessionStorage.getItem("pairList"),c=l?JSON.parse(l):[],[a,o]=d.useState(""),[i,h]=d.useState("USDT"),[N,k]=d.useState(0),[g,y]=d.useState([]),[p,b]=d.useState(!1);d.useEffect(()=>{a.length&&D(a)?C():y([])},[a,i]);async function C(){b(!0);const e=[];for(let t=0;t<c.length;t++){if(!(G(c[t].token.address,a)&&c[t].gold.symbol.toLowerCase()===i.toLowerCase()))continue;const x=await S(c[t].address,r);e.push({...c[t],...x});break}if(e.length===0){const t=await R({...$[r].ControllerConfig,functionName:"getPair",args:[a,f[r][N].address]});if(BigInt(t)>0){const x=await S(t,r),{symbol:P,decimals:q,formatted:E}=await U({address:u??"0x",token:a});e.push({...x,gold:f[r][N],token:{symbol:P,decimals:q,address:a,name:"",totalSupply:0,balance:E},address:t,volume:"0",marketValue:"0"})}}y(e),b(!1)}function I(e){o(e.target.value)}function w(e){sessionStorage.setItem("pair",V(e)),location.href=`${location.origin}/dex/#/`}return s.jsxs("div",{className:"search-token",children:[s.jsxs("div",{className:"header",children:[s.jsxs("div",{className:"search-input",children:[s.jsx("img",{src:F}),s.jsx("input",{type:"text",autoFocus:!0,value:a,onChange:I})]}),s.jsx("span",{onClick:()=>m(-1),children:n("cancel")})]}),s.jsxs("div",{className:"hot",children:[s.jsx("span",{className:"title",children:n("market")}),s.jsx("div",{className:"list",children:(f[r]??[]).map((e,t)=>s.jsx("span",{className:e.symbol===i?"active":"",onClick:()=>{h(e.symbol),k(t)},children:e.symbol},e.address))})]}),s.jsxs("div",{className:"result",children:[a.length?s.jsx("h4",{className:"title",children:n("search_results")}):null,p?s.jsxs("div",{className:"loading",children:[s.jsx("img",{src:J}),s.jsx("span",{children:n("searching")})]}):null,!p&&a.length>0&&g.length===0?s.jsxs("div",{className:"empty",children:[s.jsx("img",{src:Q}),s.jsx("span",{children:n("no_search_content_yet")})]}):null,!p&&g.length?s.jsxs("div",{className:"list",children:[s.jsxs("div",{className:"title",children:[s.jsx("span",{children:n("currency")}),s.jsx("span",{children:n("last_price")}),s.jsx("span",{children:n("quote_change")})]}),g.map(e=>s.jsxs("div",{className:"list-item",onClick:()=>w(e),children:[s.jsxs("div",{className:"token",children:[e.logoURI?s.jsx("img",{className:"logo",src:e.logoURI}):s.jsx("i",{className:"logo"}),s.jsxs("span",{children:[s.jsxs("span",{children:[e.token.symbol,"/"]}),e.gold.symbol]})]}),s.jsx("span",{className:"price",children:j(e.price,3)}),s.jsx("span",{className:e.isDrop?"quote drop":"quote",children:e.quote})]},e.address))]}):null]})]})}export{M as default};
